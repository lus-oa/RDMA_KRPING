# RDMA_KRPING
**demo**

![RDMA FLOW](https://github.com/fusemen/RDMA_KRPING/assets/122666739/4dfb93be-e11a-4247-848f-ed2519112b01)

<br/>

### ä»£ç æµ‹è¯•æ–¹æ³•

**1.å®‰è£…é©±åŠ¨ç¨‹åºã€‚æ‰§è¡Œ`./init_client.sh`**

**2.clientç«¯æ‰§è¡Œ`./run_client.sh`**
  - åŒç«¯ä¼šè¿›è¡Œå»ºé“¾æ“ä½œ
  - serverç«¯æ‰§è¡Œå¯¹åº”çš„`./run_server.sh`ã€‚ğŸ””æ³¨æ„å…ˆè¿è¡Œ`serverç«¯`ï¼Œå†è¿è¡Œ`clientç«¯`ã€‚

**3.å»ºé“¾æˆåŠŸä¹‹åclientç«¯ä¼šè¢«é˜»å¡ï¼Œç­‰å¾…ç³»ç»Ÿä¸­å¯¹SSDçš„è¯»å†™æ“ä½œä¿¡å·flagã€‚**<br/>
  - åˆ©ç”¨å‡½æ•° **wait_event_interruptible(cb->sem, flag == 1)** å°†è¿›ç¨‹é˜»å¡ï¼Œç­‰å¾…æ¡ä»¶flag=1æ»¡è¶³ç»§ç»­æ‰§è¡Œã€‚

**4.åœ¨clientç«¯è¿è¡Œç¨‹åº`./write_data`**<br/>
  - `write_data.c`æ˜¯å¯¹ä½¿ç”¨blk_opsæ³¨å†Œçš„block_devè¿›è¡Œè¯»å†™çš„ç¨‹åº,è¯¦ç»†ä»‹ç»åœ¨[è¿™é‡Œ](https://github.com/fusemen/REGISTER-BLOCK-DEVICE)ã€‚
  - flagä¸ºå…¨å±€ä¿¡å·ï¼Œåœ¨å¯¹å—è®¾å¤‡blockdevè¿›è¡Œè¯»å†™æ“ä½œä¸­ï¼Œè‹¥æ£€æµ‹åˆ°è¯»å†™ç¨‹åºåä¸º"write_data",åˆ™å°†è¯¥ç¨‹åºæ­£åœ¨æ‰§è¡Œçš„requeståˆ©ç”¨print_request(rq)å‡½æ•°æˆªå–,å…·ä½“åŸç†åŠæ–¹æ³•åœ¨[è¿™é‡Œ](https://github.com/fusemen/BIO-to-RDMA)æœ‰è¯¦ç»†ä»‹ç»ã€‚
  - è·å–æ­£åœ¨æ‰§è¡Œçš„requestçš„è¯»å†™æ ‡å¿—/è™šæ‹Ÿåœ°å€/æ•°æ®é•¿åº¦ç­‰ä¿¡æ¯ï¼Œåˆ©ç”¨è™šæ‹Ÿåœ°å€å°†å†…å­˜ä¸­çš„æ•°æ®è¯»å–åˆ°ç¼“å†²åŒºä¸­ã€‚
  - åŒæ—¶å°†flagç½®1ï¼Œè¢«é˜»å¡çš„ç¨‹åºç»§ç»­æ‰§è¡Œã€‚
  
**5.å°†ç¼“å†²åŒºä¸­çš„æ•°æ®é€šè¿‡RDMAæ“ä½œå‘é€ç»™serverç«¯ã€‚**
  - è¢«é˜»å¡çš„è¿›ç¨‹é€šè¿‡ **wake_up_interruptible(&cb->sem)** è¿›è¡Œå”¤é†’ï¼Œç»§ç»­æ‰§è¡Œå¼€å§‹RDMAè¯»å†™æ“ä½œã€‚

**6.åŒç«¯ç¨‹åºè¿è¡Œç»“æŸï¼Œåˆ©ç”¨`dmesg`æ‰“å°ç³»ç»Ÿæ—¥å¿—æŸ¥çœ‹è¯»å†™æ˜¯å¦æˆåŠŸã€‚**




